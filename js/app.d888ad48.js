(function(){"use strict";var t={2006:function(t,e,o){var i=o(9242),n=o(3396),a=o(7139);const r={key:0},s={class:"inputs"},l={key:1},c=(0,n._)("p",null,"ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶ï¼Œè¯·å…ˆåœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€è¯ä¹¦è®¤è¯ç•Œé¢å¹¶æ‰‹åŠ¨è®¤è¯",-1),d=(0,n._)("p",null,"åŽç»­åªè¦é“¾æŽ¥ipç›¸åŒï¼Œå°±æ— éœ€é‡å¤æ“ä½œ",-1);function u(t,e,o,u,h,p){const v=(0,n.up)("LocationComponent"),m=(0,n.up)("DeviceMovement");return(0,n.wg)(),(0,n.iD)(n.HY,null,[h.ready?((0,n.wg)(),(0,n.iD)("h4",l,(0,a.zw)(`âœ…å·²æˆåŠŸè¿žæŽ¥è‡³${h.socket.url}`),1)):((0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",s,[(0,n.wy)((0,n._)("input",{placeholder:"{{ip1}}","onUpdate:modelValue":e[0]||(e[0]=t=>h.ip1=t)},null,512),[[i.nr,h.ip1]]),(0,n.wy)((0,n._)("input",{placeholder:"{{ip2}}","onUpdate:modelValue":e[1]||(e[1]=t=>h.ip2=t)},null,512),[[i.nr,h.ip2]]),(0,n.wy)((0,n._)("input",{placeholder:"{{ip3}}","onUpdate:modelValue":e[2]||(e[2]=t=>h.ip3=t)},null,512),[[i.nr,h.ip3]]),(0,n.wy)((0,n._)("input",{placeholder:"{{ip4}}","onUpdate:modelValue":e[3]||(e[3]=t=>h.ip4=t)},null,512),[[i.nr,h.ip4]])]),(0,n._)("button",{class:"connect",onClick:e[4]||(e[4]=t=>p.goto())},"ðŸ”—è¯ä¹¦è®¤è¯ç•Œé¢")])),(0,n._)("div",null,[(0,n._)("button",{onClick:e[5]||(e[5]=(...t)=>p.connect&&p.connect(...t))},(0,a.zw)(h.ready?"é‡è¿ž":"å¼€å¯é“¾æŽ¥"),1)]),(0,n.Wm)(v,{url:h.ready?h.wss_url:void 0,ref:"Location"},null,8,["url"]),(0,n.Wm)(m,{url:h.ready?h.wss_url:void 0,ref:"Movement"},null,8,["url"]),c,d],64)}const h={key:0},p=(0,n._)("h3",null,"ðŸ§­è®¾å¤‡ä½ç½®",-1),v={key:1};function m(t,e,o,i,r,s){return(0,n.wg)(),(0,n.iD)(n.HY,null,[r.locationFound?((0,n.wg)(),(0,n.iD)("div",h,[p,(0,n._)("p",null,(0,a.zw)("ðŸŒç»åº¦ï¼š"+r.latitude),1),(0,n._)("p",null,(0,a.zw)("ðŸŒçº¬åº¦ï¼š"+r.longitude),1),(0,n._)("p",null,(0,a.zw)("â¬†ï¸æŒ‡å‘ï¼š"+r.heading),1),(0,n._)("p",null,(0,a.zw)("ðŸš—é€Ÿåº¦ï¼š"+r.speed),1),(0,n._)("p",null,(0,a.zw)("ðŸ”ºç²¾ç¡®åº¦ï¼š"+r.accuracy+"ç±³"),1)])):((0,n.wg)(),(0,n.iD)("h1",v,"æ‰¾ä¸åˆ°ä½ç½®ï¼")),(0,n._)("p",null,(0,a.zw)("â±ï¸ä¸Šä¸€æ¬¡å®šä½æ›´æ–°æ—¶é—´ï¼š"+r.lastTime),1)],64)}var g={name:"LocationComponent",props:{url:String},methods:{setUrl(t){console.log("è®¾å¤‡ä½ç½®æ•°æ®ä¼ è¾“å…³é—­"),this.socket&&this.socket.close(),this.socket=new WebSocket(t),console.log("æ–°çš„è®¾å¤‡ä½ç½®æ•°æ®ä¼ è¾“å·²å¼€å¯")},success(t){this.locationFound=!0,console.log("èŽ·å–å®šä½æ•°æ®"),this.data=t,this.lastTime=new Date(t.timestamp).toLocaleTimeString();const e=t.coords;if(this.latitude=e.latitude,this.longitude=e.longitude,this.accuracy=e.accuracy,this.heading=e.heading,this.speed=e.speed,void 0==this.socket)return;let o={type:"Geolocation",timestamp:t.timestamp,latitude:t.coords.latitude,longitude:t.coords.longitude,altitude:t.coords.altitude,accuracy:t.coords.accuracy,altitudeAccuracy:t.coords.altitudeAccuracy,heading:t.coords.heading,speed:t.coords.speed};this.socket.send(JSON.stringify(o))},error(t){this.locationFound=!1,console.warn(`ERROR(${t.code}): ${t.message}`)}},data(){return{data:void 0,socket:void 0,latitude:"",longitude:"",accuracy:"",lastTime:"",heading:"",speed:"",locationFound:!1,options:{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}}},mounted(){"geolocation"in navigator&&(console.log("å¼€å§‹å®šä½!"),navigator.geolocation.watchPosition(this.success,this.error,this.options))}},w=o(89);const f=(0,w.Z)(g,[["render",m]]);var y=f;const _={key:1},k=(0,n._)("h3",null,"ðŸ“±è®¾å¤‡çŠ¶æ€",-1),b=(0,n._)("h4",null,"ðŸ”¸å…­è½´åŠ é€Ÿåº¦",-1),$={key:2},O=(0,n._)("h4",null,"ðŸ”ƒè®¾å¤‡æ—‹è½¬è§’(deg)",-1);function D(t,e,o,i,r,s){return(0,n.wg)(),(0,n.iD)(n.HY,null,[r.move_data||r.ori_data?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("button",{key:0,onClick:e[0]||(e[0]=(...t)=>s.grantPermissions&&s.grantPermissions(...t))},"å¼€å¯è¿åŠ¨ä¼ æ„Ÿå™¨")),r.move_data?((0,n.wg)(),(0,n.iD)("div",_,[k,b,(0,n._)("p",null,(0,a.zw)(`X:${r.move_data.acceleration.x.toFixed(2)} Y:${r.move_data.acceleration.y.toFixed(2)} Z:${r.move_data.acceleration.z.toFixed(2)}`),1),(0,n._)("p",null,(0,a.zw)(`Alpha:${r.move_data.rotationRate.alpha.toFixed(2)} Beta:${r.move_data.rotationRate.beta.toFixed(2)} Gamma:${r.move_data.rotationRate.gamma.toFixed(2)}`),1)])):(0,n.kq)("",!0),r.ori_data?((0,n.wg)(),(0,n.iD)("div",$,[O,(0,n._)("p",null,(0,a.zw)(`Alpha:${r.ori_data.alpha.toFixed(2)} Beta:${r.ori_data.beta.toFixed(2)} Gamma:${r.ori_data.gamma.toFixed(2)}`),1)])):(0,n.kq)("",!0)],64)}var x={name:"DeviceMovement",props:{url:String},data(){return{move_data:void 0,ori_data:void 0,socket:void 0}},methods:{setUrl(t){console.log("è®¾å¤‡è¿åŠ¨æ•°æ®ä¼ è¾“å…³é—­"),this.socket&&this.socket.close(),this.socket=new WebSocket(t),console.log("æ–°çš„è®¾å¤‡è¿åŠ¨æ•°æ®ä¼ è¾“å·²å¼€å¯")},handleMotionEvent(t){if(this.move_data=t,null!=this.url){if(void 0==this.socket)return;let e={type:"DeviceMotion",timestamp:Date.now(),acceleration:{x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z},accelerationIncludingGravity:{x:t.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z},rotationRate:{alpha:t.rotationRate.alpha,beta:t.rotationRate.beta,gamma:t.rotationRate.gamma}};this.socket.send(JSON.stringify(e))}},handleOrientationEvent(t){if(this.ori_data=t,null!=this.url){void 0==this.socket&&(this.socket=new WebSocket(this.url));let e={type:"DeviceOrientation",timestamp:Date.now(),alpha:t.alpha,beta:t.beta,gamma:t.gamma};this.socket.send(JSON.stringify(e))}},iphonePermission(){DeviceMotionEvent.requestPermission().then((t=>{"granted"==t?window.addEventListener("devicemotion",this.handleMotionEvent):alert("æ— æ³•èŽ·å¾—è®¾å¤‡è¿åŠ¨æ•°æ®ï¼")})),DeviceOrientationEvent.requestPermission().then((t=>{"granted"==t?window.addEventListener("deviceorientation",this.handleOrientationEvent):alert("æ— æ³•èŽ·å¾—è®¾å¤‡æ–¹å‘æ•°æ®ï¼")}))},androidPermission(){window.addEventListener("devicemotion",this.handleMotionEvent),window.addEventListener("deviceorientation",this.handleOrientationEvent)},grantPermissions(){/iPhone/i.test(navigator.userAgent)?this.iphonePermission():/Android/i.test(navigator.userAgent)?this.androidPermission():alert(`ä¸æ”¯æŒçš„çš„UserAgent: ${navigator.userAgent}`)}}};const z=(0,w.Z)(x,[["render",D]]);var M=z,P={name:"App",components:{LocationComponent:y,DeviceMovement:M},data(){return{isMobile:!1,ip:"192.168.31.200",port:"8765",wss_url:void 0,socket:void 0,ready:!1,timer:null,ip1:"192",ip2:"168",ip3:"31",ip4:"200"}},methods:{goto(){window.open(`https://${this.ip1}.${this.ip2}.${this.ip3}.${this.ip4}:${this.port}`,"_blank")},heartbeat(){if(!this.socket)return;let t={type:"Heartbeat",timestamp:Date.now()};this.socket.send(JSON.stringify(t))},connect(){this.socket&&(this.socket.close(),console.log("å·²å…³é—­ä¸Šæ¬¡é“¾æŽ¥")),this.wss_url=`wss://${this.ip1}.${this.ip2}.${this.ip3}.${this.ip4}:${this.port}`,console.log(`æ­£åœ¨è¿žæŽ¥${this.wss_url}`);try{this.socket=new WebSocket(this.wss_url),this.socket.onerror=t=>{console.log(t),alert("è¿žæŽ¥å¤±è´¥ï¼è¯·æ£€æŸ¥é“¾æŽ¥æ˜¯å¦è¾“å…¥æ­£ç¡®ï¼Œä»¥åŠæ˜¯å¦å·²è¿›è¡Œäº†è¯ä¹¦è®¤è¯"),this.ready=!1},this.socket.onopen=t=>{console.log("WSSè¿žæŽ¥æˆåŠŸï¼"),console.log(t),this.ready=!0,this.$refs.Movement.setUrl(this.wss_url),this.$refs.Location.setUrl(this.wss_url)}}catch{alert("è¿žæŽ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥åŽé‡è¯•ï¼"),console.log("åˆ›å»ºå¤±è´¥ï¼"),this.ready=!1}}},mounted(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(console.log("ç§»åŠ¨è®¾å¤‡"),this.isMobile=!0):(this.isMobile=!1,console.log("æ¡Œé¢è®¾å¤‡")),this.timer=setInterval((()=>{this.heartbeat()}),1e3)},beforeUnmount(){clearInterval(this.timer)}};const E=(0,w.Z)(P,[["render",u]]);var A=E;const F=(0,i.ri)(A);F.mount("#app")}},e={};function o(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,o),a.exports}o.m=t,function(){var t=[];o.O=function(e,i,n,a){if(!i){var r=1/0;for(d=0;d<t.length;d++){i=t[d][0],n=t[d][1],a=t[d][2];for(var s=!0,l=0;l<i.length;l++)(!1&a||r>=a)&&Object.keys(o.O).every((function(t){return o.O[t](i[l])}))?i.splice(l--,1):(s=!1,a<r&&(r=a));if(s){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[i,n,a]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,a,r=i[0],s=i[1],l=i[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(l)var d=l(o)}for(e&&e(i);c<r.length;c++)a=r[c],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(d)},i=self["webpackChunkcompanion"]=self["webpackChunkcompanion"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=o.O(void 0,[998],(function(){return o(2006)}));i=o.O(i)})();
//# sourceMappingURL=app.d888ad48.js.map